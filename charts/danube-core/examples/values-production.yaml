# Production configuration with persistence and resource limits
# Suitable for production deployments with high availability

global:
  clusterName: "danube-prod"

broker:
  replicaCount: 3
  image:
    repository: ghcr.io/danube-messaging/danube-broker
    tag: v0.7.2
    pullPolicy: IfNotPresent
  persistence:
    enabled: true
    size: 50Gi
    storageClass: "fast-ssd"
  resources:
    requests:
      memory: "2Gi"
      cpu: "1000m"
    limits:
      memory: "4Gi"
      cpu: "2000m"
  externalAccess:
    enabled: true
    type: NodePort
    advertisedAddrTemplate: "$(POD_NAME).{{ include \"danube-core.broker.headless\" . }}.$(POD_NAMESPACE).svc.cluster.local:$(ADVERTISED_PORT)"
    advertisedPort: 6650

etcd:
  replicaCount: 3
  image:
    repository: quay.io/coreos/etcd
    tag: v3.5.9
    pullPolicy: IfNotPresent
  persistence:
    enabled: true
    size: 10Gi
    storageClass: "fast-ssd"
  resources:
    requests:
      memory: "1Gi"
      cpu: "500m"
    limits:
      memory: "2Gi"
      cpu: "1000m"

prometheus:
  enabled: true
  serviceAccount:
    create: true
  rbac:
    create: true
  resources:
    requests:
      memory: "512Mi"
      cpu: "500m"
    limits:
      memory: "1Gi"
      cpu: "1000m"

ingress:
  enabled: true
  className: "nginx"
  annotations:
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
  hosts:
    - host: danube.example.com
      paths:
        - path: /admin
          pathType: Prefix
          servicePort: admin
        - path: /metrics
          pathType: Prefix
          servicePort: prometheus
  tls:
    - secretName: danube-tls
      hosts:
        - danube.example.com
